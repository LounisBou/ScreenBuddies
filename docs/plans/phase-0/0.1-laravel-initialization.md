# Phase 0.1: Laravel Project Initialization

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Initialize a fresh Laravel 11 project configured for PostgreSQL and Redis.

**Architecture:** Clean Laravel 11 installation with PostgreSQL as primary database and Redis for caching/sessions.

**Tech Stack:** PHP 8.3, Laravel 11, PostgreSQL 16, Redis 7

**Prerequisites:**
- PHP 8.3 installed with required extensions (pgsql, redis, mbstring, xml, curl, zip)
- Composer 2.x installed
- PostgreSQL 16 running locally
- Redis 7 running locally
- Git configured with user name and email

**Reference:** `docs/specifications/03-backend-architecture.md`

---

## Task 1: Verify Prerequisites

**Files:** None

**Step 1: Check PHP version**

Run:
```bash
php -v
```

Expected: `PHP 8.3.x` or higher

**Step 2: Check required PHP extensions**

Run:
```bash
php -m | grep -E 'pgsql|redis|mbstring|xml|curl|zip'
```

Expected: All 6 extensions listed (pgsql, redis, mbstring, xml, curl, zip)

**Step 3: Check Composer version**

Run:
```bash
composer --version
```

Expected: `Composer version 2.x.x`

**Step 4: Check PostgreSQL is running**

Run:
```bash
pg_isready
```

Expected: `/tmp:5432 - accepting connections` or similar

**Step 5: Check Redis is running**

Run:
```bash
redis-cli ping
```

Expected: `PONG`

---

## Task 2: Create Laravel Project

**Files:**
- Create: `backend/` directory with fresh Laravel 11 installation

**Step 1: Navigate to project root**

Run:
```bash
cd /Users/lounis/dev/ScreenBuddies
```

**Step 2: Create Laravel project**

Run:
```bash
composer create-project laravel/laravel backend
```

Expected: Installation completes with message "Application ready! Build something amazing."

**Step 3: Verify Laravel installation**

Run:
```bash
cd backend && php artisan --version
```

Expected: `Laravel Framework 11.x.x`

---

## Task 3: Create PostgreSQL Database

**Files:** None

**Step 1: Create the database**

Run:
```bash
createdb screenbuddies
```

Expected: No output (success) or database already exists error

**Step 2: Verify database exists**

Run:
```bash
psql -l | grep screenbuddies
```

Expected: Line showing `screenbuddies` database

---

## Task 4: Configure Environment Variables

**Files:**
- Modify: `backend/.env`

**Step 1: Read current .env file**

Read `backend/.env` to understand current configuration.

**Step 2: Update .env with PostgreSQL and Redis configuration**

Replace the database and cache sections in `backend/.env`:
```env
APP_NAME=ScreenBuddies
APP_ENV=local
APP_DEBUG=true
APP_URL=http://localhost:8000

DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=screenbuddies
DB_USERNAME=lounis
DB_PASSWORD=

REDIS_HOST=127.0.0.1
REDIS_PORT=6379

CACHE_STORE=redis
QUEUE_CONNECTION=redis
SESSION_DRIVER=redis
```

Note: Adjust `DB_USERNAME` and `DB_PASSWORD` based on local PostgreSQL configuration.

**Step 3: Verify .env changes saved**

Run:
```bash
grep -E 'DB_CONNECTION|CACHE_STORE|QUEUE_CONNECTION' backend/.env
```

Expected:
```
DB_CONNECTION=pgsql
CACHE_STORE=redis
QUEUE_CONNECTION=redis
```

---

## Task 5: Test Database Connection

**Files:** None

**Step 1: Run migrations to test connection**

Run:
```bash
cd backend && php artisan migrate
```

Expected: Migration table created and default Laravel migrations run successfully.

**Step 2: Verify tables exist**

Run:
```bash
psql screenbuddies -c '\dt'
```

Expected: List of tables including `migrations`, `users`, `password_reset_tokens`, etc.

---

## Task 6: Test Redis Connection

**Files:** None

**Step 1: Test cache via artisan**

Run:
```bash
cd backend && php artisan tinker --execute="Cache::put('test', 'value', 60); echo Cache::get('test');"
```

Expected: `value`

**Step 2: Verify Redis received the key**

Run:
```bash
redis-cli keys '*test*'
```

Expected: A key containing "test" in the list

---

## Task 7: Start Development Server

**Files:** None

**Step 1: Start Laravel development server**

Run:
```bash
cd backend && php artisan serve &
```

**Step 2: Test server is responding**

Run:
```bash
curl -s http://localhost:8000 | head -20
```

Expected: HTML response containing "Laravel"

**Step 3: Stop the server**

Run:
```bash
pkill -f "php artisan serve"
```

---

## Task 8: Initial Git Commit

**Files:**
- All files in `backend/`

**Step 1: Check git status**

Run:
```bash
cd backend && git status
```

Expected: Untracked files in backend directory

**Step 2: Stage all backend files**

Run:
```bash
git add backend/
```

**Step 3: Create initial commit**

Run:
```bash
git commit -m "$(cat <<'EOF'
chore: initialize Laravel 11 project

- Fresh Laravel 11 installation
- Configured for PostgreSQL database
- Redis for cache, queue, and sessions
EOF
)"
```

Expected: Commit created successfully

**Step 4: Verify commit**

Run:
```bash
git log --oneline -1
```

Expected: Commit message "chore: initialize Laravel 11 project"

---

## Phase 0.1 Completion Checklist

- [ ] PHP 8.3+ with required extensions verified
- [ ] Composer 2.x verified
- [ ] PostgreSQL running and `screenbuddies` database created
- [ ] Redis running
- [ ] Laravel 11 project installed in `backend/`
- [ ] .env configured for PostgreSQL and Redis
- [ ] Migrations run successfully
- [ ] Redis cache connection verified
- [ ] Development server tested
- [ ] Initial git commit created

---

## Next Sub-Phase

Proceed to **Phase 0.2: Development Tools Setup** for PHPStan, PHP CS Fixer, and Pest installation.
