# Phase 5.8: Finalization

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Add localization files and verify complete Flutter foundation.

**Architecture:** ARB files for English and French translations.

**Tech Stack:** Flutter l10n, intl

**Prerequisites:** Phase 5.7 complete

**Reference:** `docs/plans/phase-5-flutter-foundation.md` Tasks 13-14

---

## Task 1: Create English Translations

**Step 1: Create app_en.arb**

Create `frontend/lib/l10n/app_en.arb`:
```json
{
  "@@locale": "en",
  "appTitle": "ScreenBuddies",
  "@appTitle": {
    "description": "The application title"
  },

  "login": "Sign In",
  "register": "Sign Up",
  "logout": "Logout",

  "email": "Email",
  "emailHint": "Enter your email",
  "password": "Password",
  "passwordHint": "Enter your password",
  "confirmPassword": "Confirm Password",
  "confirmPasswordHint": "Re-enter your password",
  "displayName": "Display Name",
  "displayNameHint": "How others will see you",
  "displayNameOptional": "Display Name (optional)",

  "welcome": "Welcome",
  "welcomeBack": "Welcome Back",
  "welcomeUser": "Welcome, {name}!",
  "@welcomeUser": {
    "placeholders": {
      "name": {
        "type": "String"
      }
    }
  },

  "createAccount": "Create Account",
  "signInToContinue": "Sign in to continue",
  "signUpToGetStarted": "Sign up to get started",

  "dontHaveAccount": "Don't have an account?",
  "alreadyHaveAccount": "Already have an account?",

  "elections": "Elections",
  "newElection": "New Election",
  "createElection": "Create Election",
  "noElectionsYet": "No elections yet",
  "createFirstElection": "Create your first election to start voting!",
  "yourElectionsHere": "Your elections will appear here.",

  "verifyEmail": "Verify your email",
  "verifyEmailMessage": "Please verify your email to create elections.",
  "resend": "Resend",

  "logoutConfirmTitle": "Logout",
  "logoutConfirmMessage": "Are you sure you want to logout?",
  "cancel": "Cancel",
  "confirm": "Confirm",

  "errorEmailRequired": "Please enter your email",
  "errorEmailInvalid": "Please enter a valid email",
  "errorPasswordRequired": "Please enter your password",
  "errorPasswordTooShort": "Password must be at least 8 characters",
  "errorPasswordConfirmRequired": "Please confirm your password",
  "errorPasswordMismatch": "Passwords do not match",

  "unexpectedError": "An unexpected error occurred",
  "networkError": "No internet connection",
  "pageNotFound": "Page not found",
  "goHome": "Go Home"
}
```

**Step 2: Commit**

```bash
cd /Users/lounis/dev/ScreenBuddies
git add frontend/lib/l10n/app_en.arb
git commit -m "feat: add English translations"
```

---

## Task 2: Create French Translations

**Step 1: Create app_fr.arb**

Create `frontend/lib/l10n/app_fr.arb`:
```json
{
  "@@locale": "fr",
  "appTitle": "ScreenBuddies",

  "login": "Connexion",
  "register": "Inscription",
  "logout": "Déconnexion",

  "email": "Email",
  "emailHint": "Entrez votre email",
  "password": "Mot de passe",
  "passwordHint": "Entrez votre mot de passe",
  "confirmPassword": "Confirmer le mot de passe",
  "confirmPasswordHint": "Entrez à nouveau votre mot de passe",
  "displayName": "Nom d'affichage",
  "displayNameHint": "Comment les autres vous verront",
  "displayNameOptional": "Nom d'affichage (optionnel)",

  "welcome": "Bienvenue",
  "welcomeBack": "Bon retour",
  "welcomeUser": "Bienvenue, {name} !",

  "createAccount": "Créer un compte",
  "signInToContinue": "Connectez-vous pour continuer",
  "signUpToGetStarted": "Inscrivez-vous pour commencer",

  "dontHaveAccount": "Vous n'avez pas de compte ?",
  "alreadyHaveAccount": "Vous avez déjà un compte ?",

  "elections": "Élections",
  "newElection": "Nouvelle élection",
  "createElection": "Créer une élection",
  "noElectionsYet": "Pas encore d'élections",
  "createFirstElection": "Créez votre première élection pour commencer à voter !",
  "yourElectionsHere": "Vos élections apparaîtront ici.",

  "verifyEmail": "Vérifiez votre email",
  "verifyEmailMessage": "Veuillez vérifier votre email pour créer des élections.",
  "resend": "Renvoyer",

  "logoutConfirmTitle": "Déconnexion",
  "logoutConfirmMessage": "Êtes-vous sûr de vouloir vous déconnecter ?",
  "cancel": "Annuler",
  "confirm": "Confirmer",

  "errorEmailRequired": "Veuillez entrer votre email",
  "errorEmailInvalid": "Veuillez entrer un email valide",
  "errorPasswordRequired": "Veuillez entrer votre mot de passe",
  "errorPasswordTooShort": "Le mot de passe doit contenir au moins 8 caractères",
  "errorPasswordConfirmRequired": "Veuillez confirmer votre mot de passe",
  "errorPasswordMismatch": "Les mots de passe ne correspondent pas",

  "unexpectedError": "Une erreur inattendue s'est produite",
  "networkError": "Pas de connexion internet",
  "pageNotFound": "Page non trouvée",
  "goHome": "Retour à l'accueil"
}
```

**Step 2: Commit**

```bash
git add frontend/lib/l10n/app_fr.arb
git commit -m "feat: add French translations"
```

---

## Task 3: Generate Localization

**Step 1: Run l10n generation**

```bash
cd /Users/lounis/dev/ScreenBuddies/frontend
flutter gen-l10n
```

Expected: `lib/.dart_tool/flutter_gen/gen_l10n/` created with:
- `app_localizations.dart`
- `app_localizations_en.dart`
- `app_localizations_fr.dart`

**Step 2: Verify generation**

```bash
ls -la .dart_tool/flutter_gen/gen_l10n/
```

**Step 3: Commit**

```bash
git add .
git commit -m "chore: generate localization files"
```

---

## Task 4: Update App for Localization

**Step 1: Update app.dart**

Edit `frontend/lib/app.dart` to use generated localizations:
```dart
import 'package:flutter/material.dart';
import 'package:flutter_gen/gen_l10n/app_localizations.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'core/theme/app_theme.dart';
import 'presentation/router/app_router.dart';

class ScreenBuddiesApp extends ConsumerWidget {
  const ScreenBuddiesApp({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final router = ref.watch(routerProvider);

    return MaterialApp.router(
      title: 'ScreenBuddies',
      debugShowCheckedModeBanner: false,

      // Theming
      theme: AppTheme.light,
      darkTheme: AppTheme.dark,
      themeMode: ThemeMode.system,

      // Routing
      routerConfig: router,

      // Localization
      localizationsDelegates: AppLocalizations.localizationsDelegates,
      supportedLocales: AppLocalizations.supportedLocales,
    );
  }
}
```

**Step 2: Commit**

```bash
git add frontend/lib/app.dart
git commit -m "feat: integrate generated localizations"
```

---

## Task 5: Final Verification

**Step 1: Run the app**

```bash
cd /Users/lounis/dev/ScreenBuddies/frontend
flutter run -d chrome
```

**Step 2: Verification checklist**

Test the following:
1. [ ] App loads splash screen
2. [ ] Redirects to login after auth check
3. [ ] Login form validation works
4. [ ] Register form validation works
5. [ ] Navigate between login and register
6. [ ] Theme applies correctly (light/dark based on system)
7. [ ] No console errors

**Step 3: Build for web**

```bash
flutter build web
```
Expected: Build completes without errors

**Step 4: Commit**

```bash
git add .
git commit -m "chore: phase 5 complete - flutter foundation"
```

---

## Using Localization

To use translations in widgets:

```dart
import 'package:flutter_gen/gen_l10n/app_localizations.dart';

// In a widget:
Text(AppLocalizations.of(context)!.welcomeBack)

// With parameters:
Text(AppLocalizations.of(context)!.welcomeUser(user.displayName))
```

---

## Translation Keys Summary

| Key | English | French |
|-----|---------|--------|
| login | Sign In | Connexion |
| register | Sign Up | Inscription |
| welcomeBack | Welcome Back | Bon retour |
| createAccount | Create Account | Créer un compte |
| newElection | New Election | Nouvelle élection |
| cancel | Cancel | Annuler |
| confirm | Confirm | Confirmer |

---

## Phase 5.8 Completion Checklist

- [ ] app_en.arb with all English strings
- [ ] app_fr.arb with all French strings
- [ ] `flutter gen-l10n` runs successfully
- [ ] app.dart uses generated localizations
- [ ] App runs without errors
- [ ] Splash screen works
- [ ] Login screen works
- [ ] Register screen works
- [ ] Theme works (light/dark)
- [ ] `flutter build web` succeeds
- [ ] Final commit created

---

## Phase 5 Complete

All Flutter foundation components are now in place:

| Component | Status |
|-----------|--------|
| Flutter project | Complete |
| Dependencies | Complete |
| Directory structure | Complete |
| Theme system | Complete |
| API client | Complete |
| Secure storage | Complete |
| Offline cache | Complete |
| Auth provider | Complete |
| Router | Complete |
| Splash screen | Complete |
| Login screen | Complete |
| Register screen | Complete |
| Home screen | Complete |
| Localization | Complete |

---

## Next Phase

Proceed to **Phase 6: Flutter Election Features** for election list, details, and voting UI.
